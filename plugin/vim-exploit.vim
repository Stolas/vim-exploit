" VIM Exploit Development
" GPLv3

if !exists('g:exploit_author')
    let g:exploit_author = $USER
endif

" Exploit Development Features
function! ExploitInsertCyclicPattern()
    echo 'TODO'
endfunction

function! ExploitInsertFullByte()
    echo '\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f'
endfunction

" Create Exploit Template
function! ExploitNewPythonRemote()
    echo 'TODO'
endfunction

function! ExploitNewPythonFile()
    echo 'TODO'
endfunction

function! ExploitNewPythonIPC()
    echo 'TODO'
endfunction

function! ExploitNewMsfRemote()
    echo 'TODO'
endfunction

function! ExploitNew()
    let creation_methods = {'1. Python Remote': 'ExploitNewPythonRemote', '2. Python File': 'ExploitNewPythonFile', '3. Python IPC': 'ExploitNewPythonIPC', '4. Metasploit Remote': 'ExploitNewMsfRemote'}
    "let exploit_kind = inputlist(['--Exploit Kind--', '1. Python Remote', '2. Python File', '3. Python IPC', '4. Metasploit Remote'])
    let method_list = ['--Exploit Kind--'] + keys(creation_methods)
    let exploit_kind = inputlist(sort(method_list))
    let the_key = method_list[exploit_kind]
    let func_ptr = get(creation_methods, the_key, 'ExploitNewInvalid')
    call function(func_ptr)
endfunction
